{% extends "base.html" %}
{% load static %}

{% block title %}{% if is_create %}Add API client{% else %}Edit {{ client.name }}{% endif %}{% endblock %}

{% block content %}
<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-4">
  <h1 class="mb-0" style="background: var(--soul-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
    {% if is_create %}Add API Client{% else %}Edit {{ client.name }}{% endif %}
  </h1>
  <a href="{% url 'settings_api' %}" class="btn btn-action"><i class="fa-solid fa-arrow-left icon me-1" aria-hidden="true"></i> Back to API Management</a>
</div>

<form id="apiForm" class="form-soul card-soul p-4" style="max-width: 480px;" action="{% if is_create %}{% url 'settings_api_create' %}{% else %}{% url 'settings_api_edit' client.pk %}{% endif %}" method="post">
  {% csrf_token %}
  <div class="mb-3">
    <label class="form-label">Name</label>
    <input type="text" class="form-control" name="name" required value="{% if client %}{{ client.name }}{% endif %}" placeholder="Partner name">
  </div>
  <div class="mb-3">
    <label class="form-label">Rate limit (requests per minute)</label>
    <input type="number" class="form-control" name="rate_limit_per_min" min="1" max="1000" value="{% if client %}{{ client.rate_limit_per_min }}{% else %}60{% endif %}">
  </div>
  {% if not is_create %}
  <div class="mb-3">
    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" name="regenerate_key" id="regenerate_key">
      <label class="form-check-label" for="regenerate_key">Regenerate API key (old key will stop working)</label>
    </div>
  </div>
  {% endif %}
  <div class="mb-3">
    <div class="form-check form-switch">
      <input class="form-check-input" type="checkbox" name="is_active" {% if not client or client.is_active %}checked{% endif %}>
      <label class="form-check-label">Active</label>
    </div>
  </div>
  <div class="d-flex gap-2">
    <button type="submit" class="btn btn-soul">{% if is_create %}Create{% else %}Save{% endif %}</button>
    <a href="{% url 'settings_api' %}" class="btn btn-outline-secondary">Cancel</a>
  </div>
</form>
{% endblock %}
